3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
dplyr::summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
#   geom_bar(stat = "identity",
#            position = "fill",
#            color = NA,
#            width = 1.01) +
geom_area() +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), gray(0.75))) +
coord_cartesian(ylim = c(0,0.55)) +
theme(legend.position = 'none', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
?geom_area
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
dplyr::summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
#   geom_bar(stat = "identity",
#            position = "fill",
#            color = NA,
#            width = 1.01) +
geom_line() +
stat_smooth() +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), gray(0.75))) +
coord_cartesian(ylim = c(0,0.55)) +
theme(legend.position = 'none', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
dplyr::summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing,
group = 1
)) +
#   geom_bar(stat = "identity",
#            position = "fill",
#            color = NA,
#            width = 1.01) +
geom_line() +
stat_smooth() +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), gray(0.75))) +
coord_cartesian(ylim = c(0,0.55)) +
theme(legend.position = 'none', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
dplyr::summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties")))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
dplyr::summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing,
group = gearing,
color = gearing
)) +
#   geom_bar(stat = "identity",
#            position = "fill",
#            color = NA,
#            width = 1.01) +
geom_line() +
stat_smooth() +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), gray(0.75))) +
coord_cartesian(ylim = c(0,0.55)) +
theme(legend.position = 'none', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
dplyr::summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing,
group = gearing,
color = gearing
)) +
geom_bar(stat = "identity",
position = "fill",
color = NA,
width = 1.01) +
# geom_line() +
stat_smooth() +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), gray(0.75))) +
coord_cartesian(ylim = c(0,0.55)) +
theme(legend.position = 'none', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
dplyr::summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing,
group = gearing,
color = gearing
)) +
#   geom_bar(stat = "identity",
#            position = "fill",
#            color = NA,
#            width = 1.01) +
geom_point() +
stat_smooth() +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), gray(0.75))) +
coord_cartesian(ylim = c(0,0.55)) +
theme(legend.position = 'none', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
