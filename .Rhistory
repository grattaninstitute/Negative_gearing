tally() %>%
arrange(n)
get_sample_file(2013) %>%
filter(Net_CG_amt > 0) %>%
mutate(apparent.discount = round(2*Net_CG_amt/Tot_CY_CG_amt)/2,
apparent.discount = ifelse(abs(apparent.discount - 0.5) <= 0.02, 0.50, apparent.discount)) %>%
group_by(apparent.discount) %>%
tally() %>%
arrange(n) %>%
ungroup %>%
mutate(n.p = n/sum(n),
discount.key = cumsum(n.p))
get_sample_file(2013) %>%
filter(Net_CG_amt > 0) %>%
mutate(apparent.discount = Net_CG_amt/Tot_CY_CG_amt)) %>%
group_by(apparent.discount) %>%
tally() %>%
arrange(n) %>%
ungroup %>%
mutate(n.p = n/sum(n),
discount.key = cumsum(n.p))
get_sample_file(2013) %>%
filter(Net_CG_amt > 0) %>%
mutate(apparent.discount = Net_CG_amt/Tot_CY_CG_amt) %>%
group_by(apparent.discount) %>%
tally() %>%
arrange(n) %>%
ungroup %>%
mutate(n.p = n/sum(n),
discount.key = cumsum(n.p))
get_sample_file(2013) %>%
filter(Net_CG_amt > 0) %>%
mutate(apparent.discount = round(2*Net_CG_amt/Tot_CY_CG_amt)/2,
apparent.discount = ifelse(abs(apparent.discount - 0.5) <= 0.02, 0.50, apparent.discount)) %>%
group_by(apparent.discount) %>%
tally() %>%
arrange(n) %>%
ungroup %>%
filter(apparent.discount %in% c(0.5,1)) %>%
mutate(n.p = n/sum(n),
discount.key = cumsum(n.p))
theme_hugh
get_sample_file(2013) %>% filter(Net_rent_amt < 0) %$% sum(Net_rent_amt)
get_sample_file(2013) %>% filter(Net_rent_amt < 0) %$% sum(Net_rent_amt)*50/1e9
get_sample_file(2013) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% mean(income_no_ded > 80e3)
get_sample_file(2013) %>% filter(Net_rent_amt < 0) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% mean(income_no_ded > 80e3)
get_sample_file(2013) %>% filter(Net_rent_amt < 0) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% sum(income_no_ded > 80e3)*50
get_sample_file(2013) %>% filter(Net_rent_amt < 0) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% sum(income_no_ded < 80e3)*50
get_sample_file(2013) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% sum(income_no_ded < 80e3)*50
get_sample_file(2013) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% sum(income_no_ded < 80e3)*50/1e6
get_sample_file(2013) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% sum(income_no_ded > 80e3)*50/1e6
0.5/2.46
fread("./SIH/SIH11BP.csv")
fread("./SIH/SIH11BH.csv")
get_sample_file(2013) %>% filter(Net_rent_amt < 0) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %$% sum(income_no_ded < 80e3)*50
get_sample_file(2013) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %>% group_by(income_no_ded < 80e3) %>%  summarise(mean(Net_rent_amt < 0))
get_sample_file(2013) %>% mutate(income_no_ded = Taxable_Income - pmin(0, Net_rent_amt)) %>% group_by(income_no_ded < 100e3 & income_no_ded > 50e3) %>%  summarise(mean(Net_rent_amt < 0))
get_sample_file(2013) %>% mutate(income_no_ded = Tot_inc_amt) %>% group_by(income_no_ded < 100e3 & income_no_ded > 50e3) %>%  summarise(mean(Net_rent_amt < 0))
get_sample_file(2013) %>% filter(Gross_rent_amt > 0) %>% mutate(income_no_ded = Tot_inc_amt) %>% group_by(income_no_ded < 100e3 & income_no_ded > 50e3) %>%  summarise(mean(Net_rent_amt < 0))
get_sample_file(2013) %>% mutate(income_no_ded = Tot_inc_amt) %>% group_by(income_no_ded < 100e3 & income_no_ded > 50e3) %>%  summarise(mean(Net_rent_amt < 0))
foreign::read.dta("C:/Users/Hugh/Dropbox (Grattan Institute)/Budget Repair Report/Data and analysis/Land tax/R/HSL modelling/sih11bp.dta") -> sihp
names(sihp)
names(sihp) %>% sort
sihp %>% select(VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP)
sihp %>% select(VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP) %>% head
sihp %>% select(VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP,AGECP) %>% head
sihp %>% select(VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC) %>% head
grepl("age", names(sihp), ignore.case = TRUE, value = TRUE)
grep("age", names(sihp), ignore.case = TRUE, value = TRUE)
sihp %>% select(VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP) %>% head
sihp %>% select(VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>% head
foreign::read.dta("./SIH/sih11bp.dta") %>%
select(VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather()
names(sihp)
foreign::read.dta("./SIH/sih11bp.dta") %>%
select(LEVELPS, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(-LEVELPS)
foreign::read.dta("./SIH/sih11bp.dta") %>%
select(LEVELPS, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -LEVELPS)
foreign::read.dta("./SIH/sih11bp.dta") %>%
select(LEVELPS, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -LEVELPS) %>%
head
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -LEVELPS)
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx)
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx) %>%
group_by(idx) %>%
summarise(wealth.tot = sum(value))
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx) %>%
group_by(idx) %>%
summarise(wealth.tot = sum(as.numeric(value)))
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx) %>% filter(is.na(as.numeric(value)))
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx, -IAGECP, -AGEBC, -IAGEPP) %>%
group_by(AGEBC) %>%
summarise(wealth.tot = sum(as.numeric(value)))
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx, -IAGECP, -AGEBC, -IAGEPP) %>%
group_by(AGEBC) %>%
summarise(wealth.tot = mean(as.numeric(value)))
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx, -IAGECP, -AGEBC, -IAGEPP) %>%
group_by(AGEBC) %>%
summarise(wealth.tot = mean(as.numeric(value))) %>%
grplot(aes(x = AGEBC, y = wealth.tot)) +
geom_line(aes(group = 1))
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx, -IAGECP, -AGEBC, -IAGEPP) %>%
group_by(idx) %>%
summarise(wealth.total = sum(value)) %>%
ungroup %>%
group_by(AGEBC) %>%
summarise(wealth.tot = mean(as.numeric(wealth.total)))
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx, -IAGECP, -AGEBC, -IAGEPP)
foreign::read.dta("./SIH/sih11bp.dta") %>%
mutate(idx = 1:nrow(.)) %>%
select(idx, VSUPGCP, VSUPNCP, VFINCP, VDEBCP, VPLNCP, VINVOTCP, VIBUSCP, VPUTTCP, VPRTCP, VSIPCP, VSHARCP, AGEBC, IAGECP, IAGEPP) %>%
gather(wealth, value, -idx) %>% head
library(devtools)
install_github("amplab-extras/SparkR-pkg", subdir="pkg")
taxstats_ts %>%
filter(grepl("Net rent.*loss", `Selected items`)) %>%
filter(!grepl("property", `Selected items`)) %>%
filter(!is.na(value)) %>%
group_by(unit) %>%
arrange(fy.year) %>%
mutate(value.rel = value/first(value)) %>%
#mutate(value.real = cpi_inflator(value, from_fy = fy.year)) # requires en dash matching
mutate(fy.year = factor(fy.year, ordered = TRUE)) %>%
grplot(aes(x = fy.year, y = value.rel, color = unit, label = unit)) +
geom_line(aes(group = unit)) +
geom_dl(method = "last.qp")
taxstats_ts <- read_excel("taxstats_time_series1979-2013.xlsx", sheet = "Individuals Table 1", skip = 2, na = "na") %>%
setnames(2, "unit") %>%
filter(!is.na(unit))
taxstats_ts <- taxstats_ts %>%
gather_("fy.year", "value", grep("[0-9]{4}", names(taxstats_ts))) %>%
# getting real tired of en-dashes posing as hyphens.  Anything that's not a number is a hyphen
mutate(fy.year = gsub("[^0-9]", "-", fy.year)) %>%
mutate(fy.year = ifelse(fy.year == "1999-2000", "1999-00", fy.year))
taxstats_ts %>%
filter(grepl("Net rent.*loss", `Selected items`)) %>%
filter(!grepl("property", `Selected items`)) %>%
filter(!is.na(value)) %>%
group_by(unit) %>%
arrange(fy.year) %>%
mutate(value.rel = value/first(value)) %>%
#mutate(value.real = cpi_inflator(value, from_fy = fy.year)) # requires en dash matching
mutate(fy.year = factor(fy.year, ordered = TRUE)) %>%
grplot(aes(x = fy.year, y = value.rel, color = unit, label = unit)) +
geom_line(aes(group = unit)) +
geom_dl(method = "last.qp")
taxstats_ts %>%
filter(grepl("Net rent.*loss", `Selected items`)) %>%
filter(!grepl("property", `Selected items`)) %>%
filter(!is.na(value)) %>%
mutate(value = ifelse(grepl("\\$", unit), cpi_inflator(value, from_fy = fy.year), value)) %>%
group_by(unit) %>%
arrange(fy.year) %>%
mutate(value.rel = value/value[which(fy.year == "1999-00")])
taxstats_ts %>%
filter(grepl("Net rent.*loss", `Selected items`)) %>%
filter(!grepl("property", `Selected items`)) %>%
filter(!is.na(value)) %>%
mutate(value = ifelse(grepl("\\$", unit), cpi_inflator(value, from_fy = fy.year), value)) %>%
group_by(unit) %>%
arrange(fy.year) %>%
mutate(value.rel = value/value[which(fy.year == "1999-00")]) %>%
#mutate(value.real = cpi_inflator(value, from_fy = fy.year)) # requires en dash matching
mutate(fy.year = factor(fy.year, ordered = TRUE)) %>%
grplot(aes(x = fy.year, y = value.rel, color = unit, label = unit)) +
geom_line(aes(group = unit)) +
geom_dl(method = list("lines2", dl.trans(cex = 1.5, x = x + 0.1))) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title = element_blank())
fy2yr("1999-00")
fy2yr("1998-99")
fy2yr
is.fy
is.fy("2005-06")
is.fy("2004-06")
is.fy("1998-99")
is.fy("1999-00")
remove.packages("grattan")
devtools::install_github("HughParsonage/grattan")
library(grattan)
fy2date <- function(x){if(!is.fy(x)){stop("Not an FY")} else {date <- paste0(as.numeric(gsub("^([1-9][0-9]{3}).*", "\\1", x)) + 1, "-06-30"; as.Date(date)}}
fy2date <- function(x){if(!is.fy(x)){stop("Not an FY")} else {date <- paste0(as.numeric(gsub("^([1-9][0-9]{3}).*", "\\1", x)) + 1, "-06-30"); as.Date(date)}}
fy2date("1999-00")
fy2date("1999-00") + 1
remove.packages("grattan")
devtools::install_github("HughParsonage/grattan")
library(grattan)
taxstats_ts %>%
filter(grepl("Net rent.*loss", `Selected items`)) %>%
filter(!grepl("property", `Selected items`)) %>%
filter(!is.na(value)) %>%
mutate(value = ifelse(grepl("\\$", unit), cpi_inflator(value, from_fy = fy.year), value)) %>%
group_by(unit) %>%
arrange(fy.year) %>%
mutate(value.rel = value/value[which(fy.year == "1999-00")]) %>%
#mutate(value.real = cpi_inflator(value, from_fy = fy.year)) # requires en dash matching
mutate(fy.year = factor(fy.year, ordered = TRUE),
date = fy2date(as.character(fy.year))) %>%
grplot(aes(x = date, y = value.rel, color = unit, label = unit)) +
geom_line(aes(group = unit)) +
geom_dl(method = list("lines2", dl.trans(cex = 1.5, x = x + 0.1))) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title = element_blank())
taxstats_ts %>%
filter(grepl("Net rent.*loss", `Selected items`)) %>%
filter(!grepl("property", `Selected items`)) %>%
filter(!is.na(value)) %>%
mutate(value = ifelse(grepl("\\$", unit), cpi_inflator(value, from_fy = fy.year), value)) %>%
group_by(unit) %>%
arrange(fy.year) %>%
mutate(value.rel = value/value[which(fy.year == "1999-00")]) %>%
#mutate(value.real = cpi_inflator(value, from_fy = fy.year)) # requires en dash matching
mutate(fy.year = factor(fy.year, ordered = TRUE),
date = fy2date(as.character(fy.year))) %>%
grplot(aes(x = date, y = value.rel, color = unit, label = unit)) +
geom_line(aes(group = unit)) +
geom_dl(method = list("lines2", dl.trans(cex = 2.0, x = x + 0.1))) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title = element_blank(),
plot.margin = grid::unit(c(0.7,1.2,0.5,0.5), "lines"))
taxstats_ts %>%
filter(grepl("Net rent.*loss", `Selected items`)) %>%
filter(!grepl("property", `Selected items`)) %>%
filter(!is.na(value)) %>%
mutate(value = ifelse(grepl("\\$", unit), cpi_inflator(value, from_fy = fy.year), value)) %>%
group_by(unit) %>%
arrange(fy.year) %>%
mutate(value.rel = value/value[which(fy.year == "1999-00")]) %>%
#mutate(value.real = cpi_inflator(value, from_fy = fy.year)) # requires en dash matching
mutate(fy.year = factor(fy.year, ordered = TRUE),
date = fy2date(as.character(fy.year))) %>%
grplot(aes(x = date, y = value.rel, color = unit, label = unit)) +
geom_line(aes(group = unit)) +
geom_dl(method = list("lines2", dl.trans(cex = 2.0, x = x + 0.1))) +
scale_y_continuous(expand = c(0.1,0.1)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title = element_blank(),
plot.margin = grid::unit(c(0.7,1.2,0.5,0.5), "lines"))
# https://www.ato.gov.au/About-ATO/Research-and-statistics/In-detail/Tax-statistics/Taxation-statistics-2012-13/?page=11
read.table(text = "Column3	Shares	Real_estate Other_assets
Individuals	6129	8468	6882
Companies	2640	1455	8077
Funds	7340	507	4842
", header=TRUE, stringsAsFactors = FALSE) %>%
gather(Gains, value, Shares:Other_assets) %>%
mutate(value = value/1e3,
Gains = factor(Gains)) %>%
grplot(aes(x = Column3, y = value, fill = Gains)) +
geom_bar(stat = "identity", position = "stack",
width = 0.7) +
scale_y_continuous(label = grattan_dollar, expand = c(0,0), limits = c(0,25)) +
annotate("text",
x = 3.5,
hjust = 0,
vjust = 0.8,
size = 7.14,
y = c(6129, 14597, 21479)/1e3, #cumsum(c(6129,8468,6882)),
color = gpal(3),
fontface = "bold",
label = c("Shares", "Real estate", "Other")) +
annotate("blank", x = 4.6, y = 0) +
theme(axis.title = element_blank())
# https://www.ato.gov.au/About-ATO/Research-and-statistics/In-detail/Tax-statistics/Taxation-statistics-2012-13/?page=11
read.table(text = "Column3	Shares	Real_estate Other_assets
Individuals	6129	8468	6882
Companies	2640	1455	8077
Funds	7340	507	4842
", header=TRUE, stringsAsFactors = FALSE) %>%
gather(Gains, value, Shares:Other_assets) %>%
mutate(value = value/1e3,
Gains = factor(Gains)) %>%
grplot(aes(x = Column3, y = value, fill = Gains)) +
geom_bar(stat = "identity", position = "stack",
width = 0.7) +
scale_y_continuous(label = grattan_dollar, expand = c(0,0), limits = c(0,25)) +
annotate("text",
x = 3.5,
hjust = 0,
vjust = 0.9,
size = 7.14,
y = c(6129, 14597, 21479)/1e3, #cumsum(c(6129,8468,6882)),
color = gpal(3),
fontface = "bold",
label = c("Shares", "Real estate", "Other")) +
annotate("blank", x = 4.6, y = 0) +
theme(axis.title = element_blank())
23/7
23*2.5/7
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
coord_flip()
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(ncol = 2)) +
coord_flip()
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(ncol = 2)) +
coord_flip()
?guide_legend
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(ncol = 2, title.theme = element_blank())) +
coord_flip()
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(ncol = 2, title.theme = element_blank(), label.theme = element_text(size = 30))) +
coord_flip()
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(ncol = 2, title.theme = element_blank(), label.theme = element_text(angle = 0, size = 23))) +
coord_flip()
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(ncol = 2,
title.theme = element_blank(),
legend.key.height = unit(3, "lines"),
label.theme = element_text(angle = 0, size = 23))) +
coord_flip()
read_excel("ASX_Returns_by_asset_class.xlsx") %>%
gather(tax_class, returnz, -`Asset class`) %>%
# cosmetics
mutate(returnz = returnz/100,
`Asset class` = gsub("\\s+", "\n", `Asset class`),
`Asset class` = gsub("Global\\n", "Global ", `Asset class`)) %>%
#
grplot(aes(y = returnz, x = `Asset class`, fill = tax_class)) +
geom_bar(stat = "identity",
position = "dodge") +
geom_hline(yintercept = 0.028,
color = theGrey, size = 2) +
annotate("text", x = 2, y = 0.0299,
hjust = 0,
label = "CPI (2.8% p.a.)", color = theGrey, fontface = "bold",
size = 8.14) +
scale_y_continuous(expand = c(0,0), limits = c(0,0.1), label = percent) +
theme(panel.grid.major = element_blank(),
plot.margin = grid::unit(c(0.7, 2.2, 0.5, 0), "lines"),
axis.title = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(ncol = 2,
title.theme = element_blank(),
legend.key.height = unit(4, "lines"),
label.theme = element_text(angle = 0, size = 23))) +
coord_flip()
