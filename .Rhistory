'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
geom_bar(stat = "identity",
position = "fill",
width = 1) +
scale_fill_manual("", values = c(gpal(2), theGrey)) +
coord_cartesian(ylim = c(0,0.5)) +
theme(legend.position = 'bottom', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
geom_bar(stat = "identity",
position = "fill",
color = NA,
width = 1) +
scale_fill_manual("", values = c(gpal(2), theGrey)) +
coord_cartesian(ylim = c(0,0.5)) +
theme(legend.position = 'bottom', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
geom_area(stat = "identity",
position = "fill",
color = NA,
width = 1) +
scale_fill_manual("", values = c(gpal(2), theGrey)) +
coord_cartesian(ylim = c(0,0.5)) +
theme(legend.position = 'bottom', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
geom_bar(stat = "identity",
position = "fill",
color = NA,
width = 1) +
scale_fill_manual("", values = c(gpal(2), theGrey)) +
coord_cartesian(ylim = c(0,0.5)) +
theme(legend.position = 'bottom', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
geom_bar(stat = "identity",
position = "fill",
color = NA,
width = 1) +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), theGrey)) +
coord_cartesian(ylim = c(0,0.5)) +
theme(legend.position = 'bottom', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
get_sample_file(2013) %>%
mutate(Age = car::recode(age_range, "0 = '70 and over';
1 = '65 to 69';
2 = '60 to 64';
3 = '55 to 59';
4 = '50 to 54';
5 = '45 to 49';
6 = '40 to 44';
7 = '35 to 39';
8 = '30 to 34';
9 = '25 to 29';
10 = '20 to 24';
11 = 'under 20'")) %>%
mutate(Age =  factor(Age,
levels = c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over'),
labels = gsub("\\s", "\n",
c("under 20",
'20 to 24',
'25 to 29',
'30 to 34',
'35 to 39',
'40 to 44',
'45 to 49',
'50 to 54',
'55 to 59',
'60 to 64',
'65 to 69',
'70 and over')),
ordered = T)) %>%
group_by(Age) %>%
summarise(number_negatively_gearing = sum(Net_rent_amt < 0) * 50,
prop_NG_investors = sum(Gross_rent_amt > 0 & Net_rent_amt < 0) / sum(Gross_rent_amt > 0),
number_negatively_gearing_with_investment_property = sum(Net_rent_amt < 0 & Gross_rent_amt > 0)*50,
number_not_negatively_gearing_but_have_investment_property = sum(Net_rent_amt >= 0 & Gross_rent_amt > 0)*50,
neither = sum(Gross_rent_amt == 0)*50) %>%
gather(gearing, number,
number_negatively_gearing_with_investment_property,
number_not_negatively_gearing_but_have_investment_property,
neither) %>%
mutate(gearing = ifelse(gearing == "neither", "neither",
ifelse(grepl("not", gearing), "Not negative gearing", "Negative gearing"))) %>%
mutate(gearing = factor(gearing,
levels = c("Negative gearing", "Not negative gearing", "neither"),
labels = c("Negative gearing", "Not negative gearing", "No investment properties"))) %T>%
chart_data %>%
grplot(aes(Age, number, fill = gearing)) +
geom_bar(stat = "identity",
position = "fill",
color = NA,
width = 1.01) +
annotate("text",
x = c(9,9,9),
y = c(0.07, 0.17, 0.3),
label = c("Negative gearing",
"Not negative gearing",
"(No investment property)"),
fontface = "bold",
size = 7.14) +
scale_fill_manual("", values = c(gpal(2), theGrey)) +
coord_cartesian(ylim = c(0,0.5)) +
theme(legend.position = 'bottom', axis.title.x = element_text(hjust = 0.5)) +
scale_y_continuous(label=percent, expand = c(0,0))
data.frame(
Type = c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value"),
real_emtr = c(0.32, 0.155, -0.008)
) %>%
grplot(aes(x = Type, y = real_emtr)) +
geom_bar(stat = "identity") +
scale_y_continuous(expand = c(0,0), limits = c(-0.05, 0.35), label=percent)
data.frame(
Type = factor(c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value")),
real_emtr = c(0.32, 0.155, -0.008)
) %>%
grplot(aes(x = Type, y = real_emtr)) +
geom_bar(stat = "identity") +
scale_y_continuous(expand = c(0,0), limits = c(-0.05, 0.35), label=percent)
data.frame(
Type = factor(c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value"),
levels = c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value")),
real_emtr = c(0.32, 0.155, -0.008)
) %>%
grplot(aes(x = Type, y = real_emtr)) +
geom_bar(stat = "identity") +
scale_y_continuous(expand = c(0,0), limits = c(-0.05, 0.35), label=percent)
data.frame(
Type = factor(c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value"),
levels = c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value")),
real_emtr = c(0.32, 0.155, -0.008)
) %>%
grplot(aes(x = Type, y = real_emtr)) +
geom_bar(stat = "identity") +
theme(axis.title = element_blank()) +
scale_y_continuous(expand = c(0,0), limits = c(-0.05, 0.35), label=percent)
data.frame(
Type = factor(c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value"),
levels = c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value")),
real_emtr = c(0.32, 0.155, -0.008)
) %>%
grplot(aes(x = Type, y = real_emtr)) +
geom_bar(stat = "identity",
width = 0.7) +
theme(axis.title = element_blank()) +
geom_hline(intercept = 0) +
scale_y_continuous(expand = c(0,0), limits = c(-0.05, 0.35), label=percent)
data.frame(
Type = factor(c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value"),
levels = c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value")),
real_emtr = c(0.32, 0.155, -0.008)
) %>%
grplot(aes(x = Type, y = real_emtr)) +
geom_bar(stat = "identity",
width = 0.7) +
theme(axis.title = element_blank()) +
geom_hline(intercept = 0, color = "black") +
scale_y_continuous(expand = c(0,0), limits = c(-0.05, 0.35), label=percent)
data.frame(
Type = factor(c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value"),
levels = c("No borrowing", "Borrowing 50%\ninvestment value", "Borrowing 80%\ninvestment value")),
real_emtr = c(0.32, 0.155, -0.008)
) %>%
grplot(aes(x = Type, y = real_emtr)) +
geom_bar(stat = "identity",
width = 0.7) +
theme(axis.title = element_blank()) +
geom_hline(yintercept = 0, color = "black") +
scale_y_continuous(expand = c(0,0), limits = c(-0.05, 0.35), label=percent)
read_excel("Capital_city_rents_1980s.xlsx") %>%
gather(city, growth, Sydney:Australia) %>%
group_by(city) %>%
mutate(growth_r = 1 + growth/100,
level = cumprod(growth_r)) ->
chart.dat
chart.dat %>%
grplot(aes(x = Date, y = level, color = city, group = city, label = city)) +
annotate("rect",
xmin = as.POSIXct("1985-07-01"),
xmax = as.POSIXct("1987-09-30"),
ymin = -Inf,
ymax = Inf,
fill = theGrey,
alpha = 0.5) +
geom_line() +
geom_text(data = filter(chart.dat, Date == unique(Date)[14]),
hjust = 1, vjust = -1, size = 7.14, fontface = "bold") +
facet_wrap(~city, ncol = 3, nrow = 2)  +
scale_color_manual(values = c(gpal(6)[1:5], "black")) +
scale_y_continuous(breaks = c(1,2), labels = c(1,2)) +
theme(strip.text = element_blank(),
strip.background = element_blank(),
axis.title.x = element_blank())
getwd()
dir()
read_excel("Capital_city_rents_1980s.xlsx") %>%
gather(city, growth, Sydney:Australia) %>%
group_by(city) %>%
mutate(growth_r = 1 + growth/100,
level = cumprod(growth_r)) ->
chart.dat
chart.dat %>%
grplot(aes(x = Date, y = level, color = city, group = city, label = city)) +
annotate("rect",
xmin = as.POSIXct("1985-07-01"),
xmax = as.POSIXct("1987-09-30"),
ymin = -Inf,
ymax = Inf,
fill = theGrey,
alpha = 0.5) +
geom_line() +
geom_text(data = filter(chart.dat, Date == unique(Date)[14]),
hjust = 1, vjust = -1, size = 7.14, fontface = "bold") +
facet_wrap(~city, ncol = 3, nrow = 2)  +
scale_color_manual(values = c(gpal(6)[1:5], "black")) +
scale_y_continuous(breaks = c(1,2), labels = c(1,2)) +
theme(strip.text = element_blank(),
strip.background = element_blank(),
axis.title.x = element_blank())
rm(list = ls())
gc(1,1)
read_excel("Capital_city_rents_1980s.xlsx") %>%
gather(city, growth, Sydney:Australia) %>%
group_by(city) %>%
mutate(growth_r = 1 + growth/100,
level = cumprod(growth_r)) ->
chart.dat
chart.dat %>%
grplot(aes(x = Date, y = level, color = city, group = city, label = city)) +
annotate("rect",
xmin = as.POSIXct("1985-07-01"),
xmax = as.POSIXct("1987-09-30"),
ymin = -Inf,
ymax = Inf,
fill = theGrey,
alpha = 0.5) +
geom_line() +
geom_text(data = filter(chart.dat, Date == unique(Date)[14]),
hjust = 1, vjust = -1, size = 7.14, fontface = "bold") +
facet_wrap(~city, ncol = 3, nrow = 2)  +
scale_color_manual(values = c(gpal(6)[1:5], "black")) +
scale_y_continuous(breaks = c(1,2), labels = c(1,2)) +
theme(strip.text = element_blank(),
strip.background = element_blank(),
axis.title.x = element_blank())
